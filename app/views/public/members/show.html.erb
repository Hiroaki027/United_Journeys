<div class= "container">
  <div class= "row">
    <div class= "col-md-3">
      <div class= "row mt-3">
        <h2>会員情報<i class="fa-solid fa-address-book ml-2"></i></h2>
      </div>
      <div class= "row">
        <div class= "d-flex align-items-start">
          <span class= "border"><%= image_tag @member.get_profile_image %></span>
          <div class= "d-flex align-items-start flex-column">
            <% unless @member.guest_member? %>
              <div class= "mb-auto p-2">
                <%= link_to  edit_member_path(@member.id), class: 'btn btn-outline-secondary btn-block' do%>
                  <i class="fa-solid fa-user-cog"></i>
                <% end %>
              </div>
            <% end %>
            <div class= "mt-3 ml-3">
              居住地: <%= @member.residence %>
            </div>
          </div>
        </div>
      </div>
      <div class= "row">
        <div class= "col-md-12 px-0">
          <span class= "border px-5"><%= @member.nick_name %></span><span class= "border px-4">投稿数: <%= @member.posts.count %></span>
        </div>
      </div>
      <div class= "row">
        <div class= "col-md-12 border px-0 text-break" style= "height: 200px;">
          <%= @member.introduction %>
        </div>
      </div>
      <div class= "row border">
        <div class= "col-md-4 my-3 py-2">
          <% if current_member == @member %>
            <%= link_to new_post_path(@member.id) do %>
              <i class="fa-solid fa-circle-plus fa-2xl" style="color: #2460c2;"></i>
            <% end %>
          <% end %>
        </div>
        <div class= "align-self-center col-md-8">
          <i class="fa-regular fa-star"></i><%=link_to"お気に入りの投稿",favorites_member_path(@member) %>
        </div>
      </div>
      <div class= "row">
        <div class= "col-md-12 border" id="follow_count">
          <%= render "public/relationships/counter", member: @member %>
        </div>
        <div class= "col-md-12 mt-1" id= "follow_btn">
          <%= render "public/relationships/btn", member: @member %>
        </div>
        <div class= "col-md-12 mt-1">
          <% if current_member != @member && current_member.following?(@member) && @member.following?(current_member) %>
            <%= link_to 'チャットを始める', chat_path(@member.id), class: "btn btn-primary" %>
          <% end %>
        </div>
      </div>
    </div>
    <div class= "col-md-9 mt-3">
      <table class= "table table-hover mt-3">
        <thead>
          <tr>
            <th>タイトル</th>
            <th></th>
            <th>ユーザー名</th>
          <% if current_page?(posts_path) %>
            <th>作成日</th>
          <% end %>
            <th></th>
            <th></th>
            <th></th>
            <th>タグ名</th>
          </tr>
        </thead>
        <tbody>
          <% @member.posts.each  do |post| %>
            <tr>
              <td><%= post.title %></td>
              <td><%= image_tag post.post_images[0].variant(resize: '50x50') %></td>
              <td><%= post.member.nick_name %></td>
            <% if current_page?(posts_path) %>
              <td><%= post.created_at.strftime('%Y/%m/%d/%H:%M') %></td>
            <% end %>
              <td><%= link_to "詳細", post_path(post.id) %></td>
              <td id= "favorite_btn_<%= post.id %>">
                <%= render "public/favorites/favorite", post: post %>
              </td>
              <td><%= render "public/comments/counter", post: post %></td>
              <td>
                <% post.tag_list.first(2).each do |tag| %>
                  <span class="tag-btn ml-3"><%= link_to tag, tag_path(tag) %></span>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
